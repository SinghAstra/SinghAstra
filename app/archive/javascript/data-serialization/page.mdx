---
title: "Data Serialization"
date: "13-12-2025"
excerpt: "The bridge between Memory and Disk: Transforming Heap Objects into strings using JSON, and managing persistence with LocalStorage."
---

## Data Serialization & Persistence

### Serialization Architecture

So far, we have discussed data living in the `RAM`. But RAM is volatile; when you close the browser, the Heap is erased. To save data (Persistence) or send it to a server (Network), we face a physical problem.

#### A. The Problem: Heap Structure

You cannot send a "Heap Object" over a network cable.

- An Object is a scattered collection of memory addresses and pointers.
- A Network Cable (or Hard Disk) is a linear stream that only understands bits and strings. Pointers are meaningless outside the specific process that created them.

#### B. The Solution: Serialization

Serialization is the process of converting a complex `Tree/Graph Structure` (the Object) into a `Linear String` that can be stored or transmitted.

- `Serialization (Marshaling):` Object to String.
- `Deserialization (Unmarshaling):` String to Object.

---

### JSON (JavaScript Object Notation)

JSON is the universal standard for serialization in the web. It is language-independent (Python, Java, and C++ all read JSON).

#### A. The Syntax Rules

JSON looks like a JS Object, but it has strict architectural constraints to ensure it is parseable by any language.

1.  Keys must be Strings: Enclosed in double quotes `"key"`.
2.  No Functions: Logic cannot be serialized, only data.
3.  No Circular References: You cannot serialize an object that points to itself (it would create an infinite string).
4.  Data Types: limited to Strings, Numbers, Booleans, Null, Arrays, and Objects. `undefined` is not valid JSON.

#### B. The Engine Mechanisms

1.  JSON.stringify(data)

    - Action: Traverses the Heap object and builds a string.
    - Data Loss: If it encounters a Function, `undefined`, or a Symbol, it simply ignores them (removes the key).
    - Transformation: It converts `Date` objects into ISO Strings.

2.  JSON.parse(string)

    - Action: Reads a string and allocates New Memory Slots in the Heap to reconstruct the object.
    - Result: The new object is a Deep Copy of the original data (as discussed in Unit 7).

---

### Persistence (LocalStorage)

The browser provides a simple database called `localStorage` to save data across page reloads.

#### A. Architecture: String-Only Store

LocalStorage is effectively a giant `Map` that lives on the User's Hard Disk (not RAM).

- Constraint: It can ONLY store Strings.
- The Trap: If you try `localStorage.setItem('user', obj)`, the engine implicitly calls `.toString()` on your object, saving the useless string `"[object Object]"`.

#### B. The Pattern

To store Objects, you must manually Serialize and Deserialize.

```javascript
const user = { id: 1, name: "Singh" };

// 1. Write (Serialize)
// RAM Object -> JSON String -> Disk
localStorage.setItem("user", JSON.stringify(user));

// 2. Read (Deserialize)
// Disk -> JSON String -> RAM Object
const storedData = JSON.parse(localStorage.getItem("user"));
```

#### C. Performance Cost (Blocking)

LocalStorage is Synchronous.

- When you read/write large chunks of JSON, the Main Thread (Unit 10) freezes until the disk operation is complete.
- Best Practice: Only store small configuration data (auth tokens, theme preference). Never store massive datasets here; use IndexedDB for that.

---

### üìù Summary Table

| Feature           | JS Object                  | JSON String               |
| :---------------- | :------------------------- | :------------------------ |
| **Location**      | Heap Memory (RAM)          | Variable / Network / Disk |
| **Type**          | Reference Type             | Primitive (String)        |
| **Keys**          | Identifier / Symbol        | **Double Quoted String**  |
| **Values**        | Any (Functions, undefined) | Data Only (No Functions)  |
| **Circular Refs** | Allowed                    | **Throws Error**          |

| API Method       | Direction           | Data Loss Risk                |
| :--------------- | :------------------ | :---------------------------- |
| `JSON.stringify` | Object $\to$ String | Yes (Funcs/undefined removed) |
| `JSON.parse`     | String $\to$ Object | No (Strict parsing)           |
